import{a as Oe}from"/build/_shared/chunk-6VOCUJW3.js";import{a as de,b as ce,c as me,d as pe,h as Ce,i as ke,j as Se,k as tt,l as Ie,m as Te,q as st,r as Le,s as De,t as Ae}from"/build/_shared/chunk-IMR44MIP.js";import{a as ot,b as rt,c as at,d as it,e as nt}from"/build/_shared/chunk-26W54DZ2.js";import{a as W,b}from"/build/_shared/chunk-DOHUNQ66.js";import{a as te}from"/build/_shared/chunk-VYNOGOUD.js";import"/build/_shared/chunk-I2HGCWKY.js";import"/build/_shared/chunk-P4C7VRR7.js";import{e as U,g as ye}from"/build/_shared/chunk-5MKVG6TO.js";import{a as F}from"/build/_shared/chunk-E22BWNYG.js";import{a as j,b as Xe,c as et,e as le}from"/build/_shared/chunk-XO4VTVTY.js";import{A as qe,Ba as ae,C as je,Ia as Ne,Ja as V,M as xe,O as Fe,P as se,Pa as D,Qa as T,R as ve,S as We,V as Qe,b as Me,c as Pe,d as ne,da as Ze,f as Ee,g as He,ga as Ke,h as Re,i as Ue,la as Ve,p as oe,ra as Ye,ta as we,u as re,w as Ge,x as ze,xa as $e,ya as Je}from"/build/_shared/chunk-444ASF66.js";import{a as be,c as Be,m as Y}from"/build/_shared/chunk-UYURHTCR.js";import{e as R}from"/build/_shared/chunk-ADMCF34Z.js";var v=R(be(),1);var B=R(be(),1);var n=R(Y(),1);function _e({count:t,onClick:a,disabled:f}){return(0,n.jsx)("div",{className:"flex justify-center pb-4",children:(0,n.jsxs)(T,{variant:"outline",size:"sm",disabled:t<=0||f,onClick:a,className:"gap-2 border-yellow-500/50 hover:bg-yellow-500/10 text-yellow-600 dark:text-yellow-400",children:[(0,n.jsx)(se,{className:D("w-4 h-4",t>0?"fill-yellow-500 text-yellow-500":"")}),(0,n.jsx)("span",{children:"Use Hint"}),(0,n.jsx)(F,{variant:"secondary",className:"ml-1 bg-yellow-100 dark:bg-yellow-900/30 text-yellow-700 dark:text-yellow-400",children:t})]})})}function lt({data:t,onComplete:a,hintCount:f,onConsumeHint:x}){let[h,k]=(0,B.useState)(null),[i,s]=(0,B.useState)(!1),[S,w]=(0,B.useState)([]);if((0,B.useEffect)(()=>{k(null),s(!1),w([])},[t]),!t||!t.options||!Array.isArray(t.options))return null;let A=t.options.findIndex(m=>m===t.answer),L=()=>{s(!0),a(h===A)};return(0,n.jsxs)("div",{className:"space-y-6 w-full max-w-lg mx-auto",children:[(0,n.jsx)(_e,{count:f,onClick:async()=>{if(!await x())return;let u=t.options.map((_,M)=>M).filter(_=>_!==A&&!S.includes(_)).sort(()=>.5-Math.random()).slice(0,2);w(_=>[..._,...u])},disabled:i||S.length>=t.options.length-1}),t.question&&(0,n.jsx)("div",{className:"bg-secondary/30 p-6 rounded-2xl border border-border",children:(0,n.jsx)("h3",{className:"text-xl md:text-2xl font-bold text-center text-foreground leading-snug",children:t.question})}),(0,n.jsx)("div",{className:"grid grid-cols-1 md:grid-cols-2 gap-4",children:t.options.map((m,r)=>{let p=S.includes(r),u="border-2 border-transparent bg-secondary/50 hover:border-indigo-500";return p?u="opacity-30 cursor-not-allowed bg-gray-100 dark:bg-gray-800 border-transparent scale-95":i?r===A?u="bg-green-500 text-white border-green-600 shadow-lg":h===r?u="bg-red-500 text-white border-red-600":u="opacity-50 grayscale":h===r&&(u="border-indigo-500 bg-indigo-50 dark:bg-indigo-900/20 ring-2 ring-indigo-500/20 shadow-md transform scale-[1.02]"),(0,n.jsx)(b.div,{whileTap:!i&&!p?{scale:.98}:{},onClick:()=>!i&&!p&&k(r),className:`p-5 rounded-xl cursor-pointer font-bold text-lg transition-all text-left ${u}`,children:m},r)})}),(0,n.jsx)(T,{onClick:L,disabled:h===null||i,className:D("w-full h-14 text-xl font-black rounded-xl transition-all shadow-xl",i&&h===A?"bg-green-500 hover:bg-green-600 text-white":i?"bg-red-500 hover:bg-red-600 text-white":"bg-indigo-600 hover:bg-indigo-700 text-white"),children:i?h===A?"Correct! \u{1F389}":"Incorrect \u274C":"Check Answer"})]})}function dt({data:t,onComplete:a,hintCount:f,onConsumeHint:x}){let[h,k]=(0,B.useState)([]),[i,s]=(0,B.useState)([]),[S,w]=(0,B.useState)(!1);if((0,B.useEffect)(()=>{if(t&&t.segments){let r=[...t.segments];r.sort(()=>Math.random()-.5),s(r),k([]),w(!1)}},[t]),!t||!t.segments)return null;let A=async()=>{let r=h.length;if(r>=t.correctOrder.length)return;let p=t.correctOrder[r],u=t.segments[p];if(!i.includes(u)){O();return}await x()&&(s(P=>{let G=P.indexOf(u);if(G>-1){let Q=[...P];return Q.splice(G,1),Q}return P}),k(P=>[...P,u]),w(!1))},L=r=>{let p=i.indexOf(r);if(p>-1){let u=[...i];u.splice(p,1),s(u),k([...h,r]),w(!1)}},O=()=>{s([...i,...h]),k([]),w(!1)},m=()=>{let r=t.correctOrder.map(u=>t.segments[u]);if(JSON.stringify(h)===JSON.stringify(r))a(!0);else{w(!0);let u=document.getElementById("run-code-btn");u&&u.classList.add("animate-shake"),setTimeout(()=>{u&&u.classList.remove("animate-shake")},500),a(!1)}};return(0,n.jsxs)("div",{className:"space-y-8 w-full max-w-2xl mx-auto",children:[(0,n.jsx)(_e,{count:f,onClick:A,disabled:h.length===t.correctOrder.length}),(0,n.jsxs)("div",{className:D("min-h-[140px] p-6 bg-zinc-950 rounded-2xl border-4 border-dashed flex flex-wrap gap-3 content-start transition-all shadow-inner",S?"border-red-500/50 bg-red-950/10":"border-zinc-800"),children:[h.length===0&&(0,n.jsx)("div",{className:"w-full h-full flex items-center justify-center text-zinc-600 text-lg font-medium italic",children:"Tap blocks below to build the code..."}),(0,n.jsx)(W,{children:h.map((r,p)=>(0,n.jsx)(b.span,{initial:{scale:0},animate:{scale:1},className:"px-4 py-3 bg-indigo-600 text-white rounded-lg font-mono text-lg font-bold shadow-lg border-b-4 border-indigo-800",children:r},`${r}-${p}`))})]}),(0,n.jsx)("div",{className:"flex flex-wrap gap-4 justify-center min-h-[80px]",children:(0,n.jsx)(W,{children:i.map((r,p)=>(0,n.jsx)(b.button,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},exit:{opacity:0,scale:.5},whileTap:{scale:.95},onClick:()=>L(r),className:"px-4 py-3 bg-white dark:bg-zinc-800 border-2 border-zinc-200 dark:border-zinc-700 rounded-xl shadow-sm font-mono text-lg font-semibold hover:border-indigo-500 hover:text-indigo-500 hover:shadow-md transition-all border-b-4 active:border-b-2 active:translate-y-0.5",children:r},`${r}-${p}`))})}),(0,n.jsxs)("div",{className:"flex gap-4",children:[(0,n.jsx)(T,{variant:"outline",onClick:O,className:"h-14 w-14 rounded-xl border-2 hover:bg-red-50 hover:text-red-600 hover:border-red-200",children:(0,n.jsx)(Ke,{className:"w-6 h-6"})}),(0,n.jsx)(T,{id:"run-code-btn",onClick:m,className:D("flex-1 h-14 text-xl font-black rounded-xl shadow-xl transition-all",S?"bg-red-500 hover:bg-red-600 text-white":"bg-green-600 hover:bg-green-700 text-white"),disabled:h.length===0,children:S?"Incorrect Code":"Run Code \u25B6"})]})]})}function ct({data:t,onComplete:a,hintCount:f,onConsumeHint:x}){let[h,k]=(0,B.useState)(null),[i,s]=(0,B.useState)([]),[S,w]=(0,B.useState)([]);(0,B.useEffect)(()=>{if(k(null),s([]),t&&t.pairs){let m=[...t.pairs].map(r=>({val:r.right,originalLeft:r.left}));w(m.sort(()=>Math.random()-.5))}},[t]);let A=async()=>{if(!await x())return;let r=t.pairs.find(u=>!i.includes(u.left));if(!r)return;let p=[...i,r.left];s(p),p.length===t.pairs.length&&setTimeout(()=>a(!0),500)};if(!t||!t.pairs)return null;let L=m=>{i.includes(m)||k(m)},O=m=>{if(h)if(h===m.originalLeft){let r=[...i,h];s(r),k(null),r.length===t.pairs.length&&setTimeout(()=>a(!0),500)}else{let r=document.getElementById("matching-grid");r&&(r.classList.add("animate-shake"),setTimeout(()=>r.classList.remove("animate-shake"),500)),k(null),a(!1)}};return(0,n.jsxs)("div",{className:"space-y-6 w-full max-w-3xl mx-auto",children:[(0,n.jsx)(_e,{count:f,onClick:A,disabled:i.length===t.pairs.length}),(0,n.jsxs)("div",{id:"matching-grid",className:"w-full grid grid-cols-2 gap-6",children:[(0,n.jsx)("div",{className:"flex flex-col gap-4",children:t.pairs.map((m,r)=>{let p=i.includes(m.left),u=h===m.left;return(0,n.jsxs)(b.button,{whileTap:{scale:.98},onClick:()=>L(m.left),disabled:p,className:D("h-24 p-4 rounded-2xl border-b-4 flex items-center justify-center text-base font-bold transition-all shadow-sm",p?"bg-green-100 border-green-400 text-green-800 opacity-60 dark:bg-green-900/30 dark:border-green-800 dark:text-green-400":u?"bg-indigo-100 border-indigo-500 text-indigo-800 dark:bg-indigo-900/40 dark:border-indigo-500 dark:text-indigo-300 transform scale-105 shadow-md":"bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 hover:border-indigo-300 dark:hover:border-indigo-700"),children:[p&&(0,n.jsx)(oe,{className:"w-5 h-5 mr-2 text-green-600"}),m.left]},`left-${r}`)})}),(0,n.jsx)("div",{className:"flex flex-col gap-4",children:S.map((m,r)=>{let p=i.includes(m.originalLeft);return(0,n.jsx)(b.button,{whileTap:p?{}:{scale:.98},onClick:()=>O(m),disabled:p,className:D("h-24 p-4 rounded-2xl border-b-4 flex items-center justify-center text-base font-bold transition-all shadow-sm",p?"bg-green-100 border-green-400 text-green-800 opacity-60 dark:bg-green-900/30 dark:border-green-800 dark:text-green-400":"bg-white dark:bg-zinc-800 border-zinc-200 dark:border-zinc-700 hover:border-indigo-300 dark:hover:border-indigo-700"),children:m.val},`right-${r}`)})})]})]})}var mt=R(be(),1);var o=R(Y(),1);function pt({stats:t,rewards:a,unlockedBadge:f,onContinue:x}){(0,mt.useEffect)(()=>{let S=Date.now()+3e3,w=()=>{Oe({particleCount:5,angle:60,spread:55,origin:{x:0},colors:["#6366f1","#10b981","#f59e0b"]}),Oe({particleCount:5,angle:120,spread:55,origin:{x:1},colors:["#6366f1","#10b981","#f59e0b"]}),Date.now()<S&&requestAnimationFrame(w)};w()},[]);let h=s=>{let S=Math.floor(s/60),w=s%60;return`${S}:${w<10?"0":""}${w}`},k={hidden:{opacity:0},show:{opacity:1,transition:{staggerChildren:.15}}},i={hidden:{opacity:0,y:20,scale:.8},show:{opacity:1,y:0,scale:1,transition:{type:"spring",bounce:.5}}};return(0,o.jsxs)("div",{className:"flex flex-col items-center justify-center w-full h-full p-6 text-center space-y-8 bg-background/95 backdrop-blur-sm",children:[(0,o.jsxs)(b.div,{initial:{scale:0},animate:{scale:1},transition:{type:"spring",duration:.8},className:"relative",children:[(0,o.jsx)("div",{className:"absolute inset-0 bg-yellow-400 blur-[50px] opacity-20 rounded-full"}),(0,o.jsx)(ae,{className:"w-24 h-24 text-yellow-500 mx-auto drop-shadow-lg"})]}),(0,o.jsxs)("div",{className:"space-y-2",children:[(0,o.jsx)(b.h2,{initial:{opacity:0,y:10},animate:{opacity:1,y:0},className:"text-3xl font-black text-indigo-900 dark:text-indigo-100 uppercase tracking-tight",children:"Lesson Complete!"}),(0,o.jsx)(b.p,{initial:{opacity:0},animate:{opacity:1},transition:{delay:.2},className:"text-muted-foreground font-medium",children:"You're crushing it! Keep the momentum going."})]}),(0,o.jsxs)(b.div,{variants:k,initial:"hidden",animate:"show",className:"grid grid-cols-2 gap-4 w-full max-w-sm",children:[(0,o.jsx)(b.div,{variants:i,children:(0,o.jsx)(j,{className:"p-4 border-2 border-indigo-100 dark:border-indigo-900 bg-indigo-50/50 dark:bg-indigo-950/20",children:(0,o.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,o.jsx)(re,{className:"w-6 h-6 text-indigo-500"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-sm font-bold text-muted-foreground uppercase tracking-wider",children:"Time"}),(0,o.jsx)("div",{className:"text-2xl font-black text-indigo-700 dark:text-indigo-300",children:h(t.timeSeconds)})]})]})})}),(0,o.jsx)(b.div,{variants:i,children:(0,o.jsx)(j,{className:"p-4 border-2 border-emerald-100 dark:border-emerald-900 bg-emerald-50/50 dark:bg-emerald-950/20",children:(0,o.jsxs)("div",{className:"flex flex-col items-center gap-2",children:[(0,o.jsx)($e,{className:"w-6 h-6 text-emerald-500"}),(0,o.jsxs)("div",{children:[(0,o.jsx)("div",{className:"text-sm font-bold text-muted-foreground uppercase tracking-wider",children:"Accuracy"}),(0,o.jsxs)("div",{className:"text-2xl font-black text-emerald-700 dark:text-emerald-300",children:[t.accuracy,"%"]})]})]})})})]}),(0,o.jsxs)(b.div,{variants:k,initial:"hidden",animate:"show",className:"w-full max-w-sm space-y-3",children:[(0,o.jsx)("div",{className:"text-sm font-bold text-muted-foreground uppercase tracking-widest text-left pl-1",children:"Rewards"}),(0,o.jsxs)(b.div,{variants:i,className:"flex gap-3",children:[(0,o.jsxs)("div",{className:"flex-1 bg-yellow-400/10 border border-yellow-400/20 rounded-xl p-3 flex items-center gap-3",children:[(0,o.jsx)("div",{className:"p-2 bg-yellow-400 rounded-lg text-yellow-900",children:(0,o.jsx)(V,{className:"w-5 h-5 fill-current"})}),(0,o.jsxs)("div",{className:"text-left",children:[(0,o.jsx)("div",{className:"text-xs font-bold text-yellow-600 dark:text-yellow-400 uppercase",children:"Total XP"}),(0,o.jsxs)("div",{className:"text-xl font-black text-yellow-700 dark:text-yellow-300",children:["+",a.xp]})]})]}),(0,o.jsxs)("div",{className:"flex-1 bg-blue-400/10 border border-blue-400/20 rounded-xl p-3 flex items-center gap-3",children:[(0,o.jsx)("div",{className:"p-2 bg-blue-400 rounded-lg text-blue-900",children:(0,o.jsx)(ze,{className:"w-5 h-5 fill-current"})}),(0,o.jsxs)("div",{className:"text-left",children:[(0,o.jsx)("div",{className:"text-xs font-bold text-blue-600 dark:text-blue-400 uppercase",children:"Coins"}),(0,o.jsxs)("div",{className:"text-xl font-black text-blue-700 dark:text-blue-300",children:["+",a.coins]})]})]})]}),f&&(0,o.jsx)(b.div,{variants:i,className:"mt-4",children:(0,o.jsxs)(j,{className:"p-4 border-2 border-purple-500 bg-purple-50 dark:bg-purple-900/20 relative overflow-hidden",children:[(0,o.jsx)("div",{className:"absolute -right-4 -top-4 bg-purple-500 text-white text-[10px] font-bold px-6 py-1 rotate-45",children:"NEW!"}),(0,o.jsxs)("div",{className:"flex items-center gap-4",children:[(0,o.jsx)("div",{className:"text-4xl",children:f.icon}),(0,o.jsxs)("div",{className:"text-left",children:[(0,o.jsx)("div",{className:"text-xs font-bold text-purple-600 dark:text-purple-400 uppercase tracking-wider",children:"Badge Unlocked"}),(0,o.jsx)("div",{className:"text-lg font-black text-purple-900 dark:text-purple-100",children:f.name}),(0,o.jsx)("div",{className:"text-xs text-muted-foreground",children:f.description})]})]})]})})]}),(0,o.jsxs)(b.div,{initial:{opacity:0,y:20},animate:{opacity:1,y:0},transition:{delay:1.5},className:"w-full max-w-sm space-y-3 pt-4",children:[(0,o.jsxs)(T,{size:"lg",className:"w-full h-14 text-lg font-bold bg-indigo-600 hover:bg-indigo-700 hover:scale-[1.02] transition-all shadow-xl shadow-indigo-500/20",onClick:x,children:["Continue ",(0,o.jsx)(ne,{className:"w-5 h-5 ml-2"})]}),(0,o.jsxs)(T,{variant:"ghost",className:"w-full text-muted-foreground hover:text-indigo-500",children:[(0,o.jsx)(Ve,{className:"w-4 h-4 mr-2"})," Share Result"]})]})]})}var ut=[{id:1,icon:Je,color:"bg-blue-500",activityLabel:"System Boot"},{id:2,icon:Ge,color:"bg-emerald-500",activityLabel:"Syntax Repair"},{id:3,icon:Re,color:"bg-indigo-500",activityLabel:"Data Sort"},{id:4,icon:qe,color:"bg-orange-500",activityLabel:"Logic Gate"},{id:5,icon:Fe,color:"bg-purple-500",activityLabel:"Flow Control"},{id:6,icon:Ze,color:"bg-pink-500",activityLabel:"Ability Forge"},{id:7,icon:Ue,color:"bg-cyan-500",activityLabel:"Construct Bay"},{id:8,icon:V,color:"bg-teal-500",activityLabel:"Pillar Defense"},{id:9,icon:je,color:"bg-yellow-500",activityLabel:"Data Stream"},{id:10,icon:Me,color:"bg-red-500",activityLabel:"Fault Zone"}],gt=[{id:1,title:"Understanding C# and .NET",description:"The Grid is offline. ION activates the Language Core.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 01: System Boot
The Grid is offline. Raw energy flows without structure. ION activates the Language Core.

ION: "Before the world can run, it must understand its language. C# is that language. .NET is the engine that sustains it."

\u{1F680} What is C#?
C# (pronounced C-sharp) is a modern, object-oriented programming language created by Microsoft. It is widely used for:
\u{1F5A5} Desktop applications
\u{1F310} Web applications
\u{1F4F1} Mobile apps
\u{1F3AE} Games (Unity)

\u2699\uFE0F What is .NET?
.NET is the development platform (engine) that runs your C# code. It manages memory, handles errors, and compiles your code.

\u{1F9E9} Analogy
C# is the language you speak. .NET is the brain that understands and executes it.
    `,codeSnippet:'Console.WriteLine("Hello, CodeON!");',keyTakeaway:"You write in C#, but .NET makes it run.",xp_reward:50,activities:[{type:"QUIZ",prompt:"Concept Check",data:{question:"Which of these is the 'Engine' that runs your code?",options:["C#",".NET","Visual Studio","CodeON"],answer:".NET"}},{type:"MATCHING",prompt:"Connect the Concepts",data:{pairs:[{left:"C#",right:"The Language"},{left:".NET",right:"The Engine"},{left:"Console",right:"Output Screen"}]}},{type:"QUIZ",prompt:"Knowledge Check",data:{question:"What is the file extension for a C# file?",options:[".py",".java",".cs",".net"],answer:".cs"}},{type:"BUILDING_BLOCKS",prompt:"Build your first command",data:{segments:["Console",".","WriteLine","(",'"Hello!"',");"],correctOrder:[0,1,2,3,4,5]}},{type:"QUIZ",prompt:"History Check",data:{question:"Who created C#?",options:["Apple","Google","Microsoft","Facebook"],answer:"Microsoft"}}]},{id:2,title:"Basic Syntax and Structure",description:"Fragments of corrupted code collapse unstable zones.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 02: Structural Integrity
Fragments of corrupted code collapse unstable zones.

ION: "Structure is survival. Without order, even power fails."

\u270D\uFE0F What is syntax?
Syntax is the rulebook of C#. Even one missing symbol can break your program.

\u{1F3D7} Structure of a C# program
Every program follows a clear structure:
1. using \u2192 imports tools
2. class \u2192 container for your code
3. Main() \u2192 where execution starts
    `,codeSnippet:`using System;

class Program
{
    static void Main()
    {
        Console.WriteLine("Welcome to CodeON");
    }
}`,keyTakeaway:"C# follows strict structure, and Main() is where everything begins.",xp_reward:100,activities:[{type:"MATCHING",prompt:"Syntax Meanings",data:{pairs:[{left:"using",right:"Import Tools"},{left:"class",right:"Code Container"},{left:"Main()",right:"Start Point"}]}},{type:"QUIZ",prompt:"Structure Check",data:{question:"Where does the C# program start executing?",options:["Start()","Run()","Main()","Begin()"],answer:"Main()"}},{type:"BUILDING_BLOCKS",prompt:"Assemble the Entry Point",data:{segments:["static","void","Main","(",")","{","}"],correctOrder:[0,1,2,3,4,5,6]}},{type:"QUIZ",prompt:"Symbol Check",data:{question:"What symbol ends a statement in C#?",options:[".",";",":",","],answer:";"}},{type:"BUILDING_BLOCKS",prompt:"Import the System",data:{segments:["using","System",";"],correctOrder:[0,1,2]}}]},{id:3,title:"Variables and Data Types",description:"Data crystals flood the sector\u2014each must be stored correctly.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 03: Memory Vaults
Data crystals flood the sector\u2014each must be stored correctly.

ION: "Power wasted is power lost. Choose the right container."

\u{1F4E6} What is a variable?
A variable is a container that stores data. It has a Type, a Name, and a Value.

\u{1F522} Common Data Types
int \u2192 whole numbers (e.g., 5)
double \u2192 decimals (e.g., 5.99)
string \u2192 text (e.g., "Alex")
bool \u2192 true / false
    `,codeSnippet:`int age = 18;
string name = "Alex";
bool isStudent = true;`,keyTakeaway:"Variables store data, and data types define what kind of data is allowed.",xp_reward:150,activities:[{type:"MATCHING",prompt:"Match Data to Type",data:{pairs:[{left:"100",right:"int"},{left:"99.5",right:"double"},{left:'"Hello"',right:"string"},{left:"true",right:"bool"}]}},{type:"QUIZ",prompt:"Type Selection",data:{question:"Which type is best for storing a user's age?",options:["string","bool","int","double"],answer:"int"}},{type:"BUILDING_BLOCKS",prompt:"Create a Text Variable",data:{segments:["string","hero","=",'"ION"',";"],correctOrder:[0,1,2,3,4]}},{type:"QUIZ",prompt:"Boolean Logic",data:{question:"What values can a 'bool' hold?",options:["Yes/No","True/False","0/1","Any text"],answer:"True/False"}},{type:"BUILDING_BLOCKS",prompt:"Define a Whole Number",data:{segments:["int","score","=","100",";"],correctOrder:[0,1,2,3,4]}}]},{id:4,title:"Operators",description:"Ancient gates respond only to precise calculations.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 04: Logic Gates
Ancient gates respond only to precise calculations.

ION: "Logic opens paths. Guessing closes them."

\u2797 What are operators?
Symbols that perform actions like math and logic.

\u{1F9EE} Types
1. Arithmetic: + - * /
2. Comparison: == != > <
3. Logical: && (AND), || (OR), ! (NOT)
    `,codeSnippet:`int total = 5 + 3;
bool isPassed = total >= 8;`,keyTakeaway:"Operators are how your code thinks and calculates.",xp_reward:150,activities:[{type:"QUIZ",prompt:"Math Check",data:{question:"What is the result of: 10 + 5?",options:["105","15","50","Error"],answer:"15"}},{type:"MATCHING",prompt:"Identify Symbols",data:{pairs:[{left:"==",right:"Equals"},{left:"!=",right:"Not Equals"},{left:"&&",right:"AND"},{left:"||",right:"OR"}]}},{type:"BUILDING_BLOCKS",prompt:"Check if Score is Passing",data:{segments:["bool","pass","=","score",">","50",";"],correctOrder:[0,1,2,3,4,5,6]}},{type:"QUIZ",prompt:"Concatenation",data:{question:"What happens when you add two strings?",options:["They multiply","They join together","It causes an error","They subtract"],answer:"They join together"}},{type:"BUILDING_BLOCKS",prompt:"Calculate Sum",data:{segments:["int","sum","=","a","+","b",";"],correctOrder:[0,1,2,3,4,5,6]}}]},{id:5,title:"Control Structures",description:"Time loops fracture the Grid, repeating endlessly.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 05: Flow Nexus
Time loops fracture the Grid, repeating endlessly.

ION: "Decisions define direction. Loops define endurance."

\u{1F500} Control Structures
They decide which code runs and when.

if / else: Makes decisions based on conditions.
for / while: Repeats tasks efficiently.
    `,codeSnippet:`if (score >= 75) {
    Console.WriteLine("Passed!");
}

for (int i = 0; i < 3; i++) {
    Console.WriteLine("Looping...");
}`,keyTakeaway:"They control decisions and repetition in your program.",xp_reward:200,activities:[{type:"MATCHING",prompt:"Flow Keywords",data:{pairs:[{left:"if",right:"Make decision"},{left:"else",right:"Alternative"},{left:"for",right:"Repeat count"},{left:"while",right:"Repeat condition"}]}},{type:"BUILDING_BLOCKS",prompt:"Construct an If Statement",data:{segments:["if","(","energy",">","0",")","{","Run();","}"],correctOrder:[0,1,2,3,4,5,6,7,8]}},{type:"QUIZ",prompt:"Loop Logic",data:{question:"Which loop is best when you know exactly how many times to repeat?",options:["while","foreach","for","if"],answer:"for"}},{type:"BUILDING_BLOCKS",prompt:"Create a While Loop",data:{segments:["while","(","isRunning",")","{","Update();","}"],correctOrder:[0,1,2,3,4,5,6]}},{type:"QUIZ",prompt:"Condition Check",data:{question:"What runs if the 'if' condition is FALSE?",options:["The if block","The else block","The program crashes","Nothing ever"],answer:"The else block"}}]},{id:6,title:"Methods",description:"Runners begin crafting repeatable skills.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 06: Ability Forge
Runners begin crafting repeatable skills.

ION: "Mastery is not repetition. It is refinement."

\u{1F9E9} What is a method?
A method is a reusable block of code that performs a specific task. Instead of writing the same code twice, you call the method.

DRY Principle: Don't Repeat Yourself.
    `,codeSnippet:`static int Add(int a, int b) 
{
    return a + b;
}`,keyTakeaway:"Methods group logic into reusable actions.",xp_reward:200,activities:[{type:"MATCHING",prompt:"Method Terms",data:{pairs:[{left:"void",right:"Returns nothing"},{left:"return",right:"Sends data back"},{left:"Parameter",right:"Input data"}]}},{type:"QUIZ",prompt:"Calling Code",data:{question:"How do you execute a method named 'Jump'?",options:["Jump","Jump();","Call Jump","Execute(Jump)"],answer:"Jump();"}},{type:"BUILDING_BLOCKS",prompt:"Define a Greeting Method",data:{segments:["void","Greet","(",")","{",'Console.WriteLine("Hi");',"}"],correctOrder:[0,1,2,3,4,5,6]}},{type:"QUIZ",prompt:"Naming Convention",data:{question:"How should public methods be named in C#?",options:["camelCase","PascalCase","snake_case","UPPERCASE"],answer:"PascalCase"}},{type:"BUILDING_BLOCKS",prompt:"Return a Value",data:{segments:["int","GetScore","(",")","{","return","100;","}"],correctOrder:[0,1,2,3,4,5,6,7]}}]},{id:7,title:"Classes and Objects",description:"Blueprints transform into living constructs.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 07: Construct Bay
Blueprints transform into living constructs.

ION: "Design shapes reality. Objects make it real."

\u{1F3ED} Class vs Object
Class: The Blueprint (e.g., definition of a Car).
Object: The Instance (e.g., that specific Red Toyota).
    `,codeSnippet:`class Car {
    public string Color;
}

Car myCar = new Car();
myCar.Color = "Red";`,keyTakeaway:"Classes define objects. Objects use those definitions.",xp_reward:250,activities:[{type:"MATCHING",prompt:"Blueprint vs Reality",data:{pairs:[{left:"Class",right:"The Blueprint"},{left:"Object",right:"The Real Thing"},{left:"new",right:"Creates Object"}]}},{type:"QUIZ",prompt:"Instantiation",data:{question:"Which keyword creates a new instance of a class?",options:["create","make","new","init"],answer:"new"}},{type:"BUILDING_BLOCKS",prompt:"Create a New Object",data:{segments:["Car","myRide","=","new","Car","(",")",";"],correctOrder:[0,1,2,3,4,5,6,7]}},{type:"QUIZ",prompt:"Accessing Data",data:{question:"How do you access a variable inside an object?",options:["Arrow (->)","Dot (.)","Slash (/)","Colon (:)"],answer:"Dot (.)"}},{type:"BUILDING_BLOCKS",prompt:"Set Object Property",data:{segments:["myRide",".","Color","=",'"Blue"',";"],correctOrder:[0,1,2,3,4,5]}}]},{id:8,title:"OOP Pillars",description:"Four ancient structures stabilize the Core.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 08: The Four Obelisks
Four ancient structures stabilize the Core.

ION: "These pillars have held worlds together. Respect them."

\u{1F3DB} The 4 Pillars
1. Encapsulation: Hiding/Protecting data.
2. Inheritance: Reusing code from a parent.
3. Polymorphism: Same action, different behaviors.
4. Abstraction: Hiding complexity.
    `,codeSnippet:`// 1. Encapsulation
// 2. Inheritance
// 3. Polymorphism
// 4. Abstraction`,keyTakeaway:"OOP pillars keep large programs organized and flexible.",xp_reward:300,activities:[{type:"QUIZ",prompt:"Pillar Knowledge",data:{question:"Which pillar involves 'Protecting Data'?",options:["Inheritance","Polymorphism","Encapsulation","Abstraction"],answer:"Encapsulation"}},{type:"MATCHING",prompt:"Match the Meaning",data:{pairs:[{left:"Inheritance",right:"Reuse Parent Code"},{left:"Polymorphism",right:"Many Forms"},{left:"Abstraction",right:"Hide Details"}]}},{type:"QUIZ",prompt:"Syntax Symbol",data:{question:"Which symbol represents Inheritance in C#?",options:[":","->","=>","::"],answer:":"}},{type:"BUILDING_BLOCKS",prompt:"Inherit a Class",data:{segments:["class","Dog",":","Animal","{","}"],correctOrder:[0,1,2,3,4,5]}},{type:"QUIZ",prompt:"Concept Check",data:{question:"What does 'Poly' mean in Polymorphism?",options:["One","Many","Hidden","Secure"],answer:"Many"}}]},{id:9,title:"Arrays and Collections",description:"Streams of entities surge through the Grid.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 09: Data Streams
Streams of entities surge through the Grid.

ION: "Single strength is fragile. Groups endure."

\u{1F4DA} Arrays vs Collections
Array []: Fixed size. Good for static lists.
List<T>: Dynamic size. Good when items are added/removed.
    `,codeSnippet:`int[] numbers = { 1, 2, 3 };
List<string> names = new List<string>();
names.Add("ION");`,keyTakeaway:"Arrays and collections store groups of data efficiently.",xp_reward:250,activities:[{type:"MATCHING",prompt:"Data Structures",data:{pairs:[{left:"Array",right:"Fixed Size"},{left:"List",right:"Dynamic Size"},{left:"Index 0",right:"First Item"}]}},{type:"BUILDING_BLOCKS",prompt:"Define a Number Array",data:{segments:["int","[","]","nums","=","{","1",",","2","}",";"],correctOrder:[0,1,2,3,4,5,6,7,8,9,10]}},{type:"QUIZ",prompt:"Counting Logic",data:{question:"If an array has 5 items, what is the index of the last item?",options:["5","4","1","0"],answer:"4"}},{type:"BUILDING_BLOCKS",prompt:"Add to List",data:{segments:["names",".","Add","(",'"ION"',")",";"],correctOrder:[0,1,2,3,4,5,6]}},{type:"QUIZ",prompt:"Syntax Check",data:{question:"Which one can change its size dynamically?",options:["Array","int","List","string"],answer:"List"}}]},{id:10,title:"Error Handling",description:"The System glitches. Failures threaten collapse.",content_markdown:`
\u{1F9ED} Lore \u2014 Sector 10: Fault Zone
The System glitches. Failures threaten collapse.

ION: "Errors are not the end. They are signals."

\u{1F6A8} Try-Catch
Error handling prevents crashes. You "try" to run risky code, and "catch" any errors if they happen.
    `,codeSnippet:`try {
    int num = int.Parse("abc");
} catch {
    Console.WriteLine("That is not a number!");
}`,keyTakeaway:"try-catch keeps your program safe from unexpected errors.",xp_reward:300,activities:[{type:"MATCHING",prompt:"Error Terms",data:{pairs:[{left:"Try",right:"Attempt Code"},{left:"Catch",right:"Handle Error"},{left:"Finally",right:"Always Runs"}]}},{type:"BUILDING_BLOCKS",prompt:"Safeguard the Code",data:{segments:["try","{","Risk();","}","catch","{","Safe();","}"],correctOrder:[0,1,2,3,4,5,6,7]}},{type:"QUIZ",prompt:"Safety Check",data:{question:"What block runs if an error happens?",options:["try","if","catch","else"],answer:"catch"}},{type:"QUIZ",prompt:"Concept Check",data:{question:"Why do we use try-catch?",options:["To make code faster","To prevent crashing","To hide code","To declare variables"],answer:"To prevent crashing"}},{type:"BUILDING_BLOCKS",prompt:"Throw an Error",data:{segments:["throw","new","Exception","(",'"Error!"',")",";"],correctOrder:[0,1,2,3,4,5,6]}}]}];var e=R(Y(),1),ft=160,yt=32;function ht({hearts:t,timeRemaining:a,buyHearts:f}){let x=t>=Le;return(0,e.jsxs)(Ce,{children:[(0,e.jsx)(ke,{asChild:!0,children:(0,e.jsxs)(T,{variant:"outline",className:"flex items-center gap-2 bg-red-50 dark:bg-red-950/30 px-3 py-1.5 h-10 rounded-full border border-red-200 dark:border-red-900 hover:bg-red-100 dark:hover:bg-red-900/50 transition-all",children:[(0,e.jsx)(xe,{className:"w-5 h-5 text-red-500 fill-red-500"}),(0,e.jsx)("span",{className:"font-bold text-red-600 dark:text-red-400 text-lg",children:t}),!x&&(0,e.jsx)("span",{className:"text-xs text-red-400/80 font-mono ml-1",children:a})]})}),(0,e.jsxs)(Se,{align:"end",className:"w-72 p-2",children:[(0,e.jsxs)(Ie,{className:"flex items-center justify-between",children:[(0,e.jsx)("span",{children:"Lives"}),(0,e.jsx)(F,{variant:x?"default":"outline",className:x?"bg-green-500":"text-orange-500 border-orange-500",children:x?"MAX":"REGENERATING"})]}),(0,e.jsx)(Te,{}),(0,e.jsxs)("div",{className:"p-3 bg-secondary/30 rounded-md mb-2 space-y-2",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,e.jsx)("span",{className:"text-muted-foreground",children:"Current Hearts"}),(0,e.jsxs)("span",{className:"font-bold",children:[t," / ",Le]})]}),!x&&(0,e.jsxs)("div",{className:"flex items-center justify-between text-sm",children:[(0,e.jsxs)("span",{className:"text-muted-foreground flex items-center gap-1",children:[(0,e.jsx)(re,{className:"w-3 h-3"})," Next in"]}),(0,e.jsx)("span",{className:"font-mono font-bold text-orange-500",children:a})]})]}),(0,e.jsxs)(T,{className:"w-full gap-2 font-bold bg-green-500 hover:bg-green-600 text-white",size:"lg",disabled:x,onClick:()=>{x||f()},children:[(0,e.jsx)(V,{className:"w-4 h-4 fill-white"}),x?"Hearts are Full":`Refill Full (${De})`]})]})]})}function xt({chapter:t,status:a,alignment:f,onClick:x,id:h}){let k=t.icon,i=a==="completed",s=a==="locked",S={hidden:{opacity:0,x:f==="left"?-20:20},visible:{opacity:1,x:0,transition:{delay:.1}}};return(0,e.jsx)(de,{delayDuration:100,children:(0,e.jsxs)(b.div,{id:h,className:"relative w-full h-40",initial:"hidden",whileInView:"visible",viewport:{once:!0,margin:"-50px"},children:[(0,e.jsx)(b.div,{variants:S,className:D("absolute w-64 top-1/2 -translate-y-1/2",f==="left"?"right-[calc(50%+5rem)]":"left-[calc(50%+5rem)]"),children:(0,e.jsxs)(j,{className:D("shadow-lg rounded-2xl transition-all border-2",s?"opacity-60 grayscale border-dashed":"hover:scale-105 cursor-pointer hover:border-indigo-400"),onClick:s?void 0:x,children:[(0,e.jsxs)(Xe,{className:"pb-2 p-4",children:[(0,e.jsxs)("div",{className:"flex justify-between items-start",children:[(0,e.jsx)(F,{variant:i?"default":"outline",className:D("mb-2 text-[10px]",i?"bg-green-500 hover:bg-green-600":""),children:i?"Completed":`Chapter ${t.order_index}`}),!s&&(0,e.jsx)(He,{className:"w-3 h-3 text-indigo-500"})]}),(0,e.jsx)(et,{className:"text-base leading-tight",children:t.title})]}),(0,e.jsx)(le,{className:"p-4 pt-0",children:(0,e.jsx)("p",{className:"text-xs text-muted-foreground line-clamp-2",children:t.description})})]})}),(0,e.jsxs)(ce,{children:[(0,e.jsx)(me,{asChild:!0,children:(0,e.jsxs)(b.button,{style:{x:"-50%",y:"0%"},whileHover:s?{}:{scale:1.15},whileTap:s?{}:{scale:.95},disabled:s,onClick:x,className:D("absolute z-10 w-20 h-20 rounded-full flex items-center justify-center border-4 border-background transition-all","left-1/2",s?"bg-muted text-muted-foreground":D(t.color,"text-white shadow-xl ring-4 ring-offset-4 ring-offset-background ring-indigo-500/20"),i&&"ring-yellow-400/50 border-yellow-100"),children:[i?(0,e.jsx)(oe,{className:"w-8 h-8 stroke-[3]"}):s?(0,e.jsx)(We,{className:"w-8 h-8"}):(0,e.jsx)(k,{className:"w-8 h-8"}),a==="current"&&(0,e.jsx)("span",{className:"absolute inset-0 rounded-full animate-ping opacity-30 bg-white"})]})}),(0,e.jsx)(pe,{side:f==="left"?"right":"left",children:(0,e.jsx)("p",{children:i?"Replay Lesson":t.activityType})})]})]})})}function vt({open:t,onClose:a,data:f}){return!t||!f?null:(0,e.jsx)(ot,{open:t,onOpenChange:a,children:(0,e.jsxs)(rt,{className:"sm:max-w-md text-center",children:[(0,e.jsxs)(at,{children:[(0,e.jsx)("div",{className:"mx-auto w-20 h-20 bg-yellow-100 rounded-full flex items-center justify-center mb-4 border-4 border-yellow-200",children:(0,e.jsx)(ae,{className:"w-10 h-10 text-yellow-600"})}),(0,e.jsx)(nt,{className:"text-2xl font-black text-center text-foreground",children:"Level Complete!"})]}),(0,e.jsxs)("div",{className:"space-y-6 py-4",children:[(0,e.jsxs)("p",{className:"text-muted-foreground",children:["You've mastered ",(0,e.jsx)("strong",{children:f.title}),"."]}),(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"flex flex-col items-center p-4 bg-secondary/50 rounded-xl border-2 border-transparent hover:border-indigo-500/20 transition-colors",children:[(0,e.jsxs)("span",{className:"text-3xl font-black text-indigo-500",children:["+",f.xp]}),(0,e.jsx)("span",{className:"text-xs text-muted-foreground uppercase font-bold tracking-wider",children:"XP Earned"})]}),(0,e.jsxs)("div",{className:"flex flex-col items-center p-4 bg-secondary/50 rounded-xl border-2 border-transparent hover:border-yellow-500/20 transition-colors",children:[(0,e.jsxs)("span",{className:"text-3xl font-black text-yellow-500",children:["+",f.coins]}),(0,e.jsx)("span",{className:"text-xs text-muted-foreground uppercase font-bold tracking-wider",children:"Coins"})]})]}),(0,e.jsxs)("div",{className:"bg-orange-50 dark:bg-orange-950/30 border border-orange-200 dark:border-orange-900/50 p-4 rounded-xl flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"text-left",children:[(0,e.jsx)("p",{className:"font-bold text-orange-700 dark:text-orange-400 text-sm",children:f.streakStatus==="continued"?"Streak Continued!":"Streak Started!"}),(0,e.jsx)("p",{className:"text-xs text-orange-600/80 dark:text-orange-400/70",children:f.streakStatus==="continued"?"You're on fire! Keep it up.":"Great start. Come back tomorrow!"})]}),(0,e.jsxs)("div",{className:"flex flex-col items-center",children:[(0,e.jsx)("span",{className:"text-2xl font-black text-orange-500",children:f.currentStreak}),(0,e.jsx)("span",{className:"text-[10px] font-bold text-orange-400 uppercase",children:"Days"})]})]})]}),(0,e.jsx)(it,{className:"sm:justify-center",children:(0,e.jsx)(T,{onClick:a,size:"lg",className:"w-full font-bold text-md h-12",children:"Continue Journey"})})]})})}function wt({chapter:t,onClose:a,onComplete:f,inventory:x,onUseHint:h}){let{user:k}=ye(),[i,s]=(0,v.useState)("lesson"),[S,w]=(0,v.useState)(!1),[A,L]=(0,v.useState)([]),[O,m]=(0,v.useState)(0),[r,p]=(0,v.useState)(0),[u,_]=(0,v.useState)(new Set);(0,v.useEffect)(()=>{if(t?.activities){let g=t.activities.map((y,C)=>({...y,_originalId:C}));L(g),p(g.length),m(0)}},[t]);let M=x?.find(g=>g.name==="Hint")?.quantity||0,[P]=(0,v.useState)(Date.now()),[G,Q]=(0,v.useState)(0),{hearts:ue,loseHeart:ge,buyHearts:$,timeRemaining:ie,isGameOver:fe,setIsGameOver:l}=Ae(k),[d,N]=(0,v.useState)("idle"),c=A[O],I=async g=>{d==="idle"&&(g?N("correct"):(N("wrong"),await ge()||(c&&c._originalId!==void 0&&_(C=>new Set(C).add(c._originalId)),L(C=>[...C,C[O]]))))},E=()=>{if(N("idle"),O<A.length-1)m(g=>g+1);else{let g=Date.now(),y=Math.floor((g-P)/1e3);Q(y),w(!0)}},z=()=>{if(t?.activities){let g=t.activities.map((y,C)=>({...y,_originalId:C}));L(g)}m(0),_(new Set),N("idle"),s("lesson"),l(!1)};return fe?(0,e.jsx)(b.div,{initial:{opacity:0},animate:{opacity:1},className:"fixed inset-0 z-[60] bg-background/95 backdrop-blur flex items-center justify-center p-4",children:(0,e.jsxs)("div",{className:"text-center space-y-6 max-w-md w-full bg-card border shadow-2xl p-8 rounded-3xl",children:[(0,e.jsx)("div",{className:"mx-auto w-24 h-24 bg-red-100 rounded-full flex items-center justify-center animate-pulse",children:(0,e.jsx)(xe,{className:"w-12 h-12 text-red-500 fill-red-500"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h2",{className:"text-3xl font-black text-foreground",children:"Out of Hearts!"}),(0,e.jsx)("p",{className:"text-muted-foreground mt-2",children:"Wait for regeneration or refill instantly."}),(0,e.jsxs)("div",{className:"mt-4 flex items-center justify-center gap-2 text-sm font-mono text-muted-foreground",children:[(0,e.jsx)(re,{className:"w-4 h-4"}),"Next heart in: ",ie||"20:00"]})]}),(0,e.jsxs)("div",{className:"flex flex-col gap-3 pt-4",children:[(0,e.jsxs)(T,{onClick:()=>{$(),l(!1)},size:"lg",className:"gap-2 w-full font-bold bg-green-500 hover:bg-green-600 text-white",children:[(0,e.jsx)(V,{className:"w-4 h-4 fill-white"}),"Refill for ",De," Coins"]}),(0,e.jsx)(T,{variant:"ghost",onClick:a,className:"w-full",children:"Give Up & Return"})]})]})}):(0,e.jsxs)(b.div,{initial:{opacity:0,y:50},animate:{opacity:1,y:0},exit:{opacity:0,y:50},className:"fixed inset-0 z-50 bg-background flex flex-col",children:[(0,e.jsxs)("div",{className:"h-16 border-b bg-background/95 backdrop-blur flex items-center justify-between px-6 shrink-0",children:[(0,e.jsxs)(T,{variant:"ghost",onClick:a,className:"gap-2",children:[(0,e.jsx)(Ne,{className:"w-5 h-5"}),(0,e.jsx)("span",{className:"hidden sm:inline",children:"Quit Lesson"})]}),i==="game"&&!S&&(0,e.jsxs)("div",{className:"flex items-center gap-6",children:[(0,e.jsx)(ht,{hearts:ue,timeRemaining:ie,buyHearts:$}),(0,e.jsx)("div",{className:"flex-1 w-32 hidden sm:block",children:(0,e.jsx)("div",{className:"h-2.5 w-full bg-secondary rounded-full overflow-hidden",children:(0,e.jsx)(b.div,{className:"h-full bg-primary",initial:{width:0},animate:{width:`${O/A.length*100}%`},transition:{duration:.5}})})})]}),(0,e.jsxs)("div",{className:"flex items-center gap-2",children:[(0,e.jsx)("span",{className:"text-sm font-bold hidden sm:inline",children:t.title}),(0,e.jsx)(F,{variant:"outline",children:i==="lesson"?"Read":"Play"})]})]}),(0,e.jsx)("div",{className:"flex-1 relative w-full overflow-hidden",children:(0,e.jsxs)(W,{mode:"wait",children:[i==="lesson"&&(0,e.jsx)(b.div,{initial:{opacity:0,x:-20},animate:{opacity:1,x:0},exit:{opacity:0,x:-20},className:"absolute inset-0 overflow-y-auto",children:(0,e.jsx)("div",{className:"max-w-4xl mx-auto px-6 py-12 min-h-full flex flex-col justify-center",children:(0,e.jsxs)("div",{className:"space-y-8",children:[(0,e.jsxs)("div",{className:"space-y-4",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("h1",{className:"text-4xl md:text-5xl font-extrabold text-primary tracking-tight",children:t.title}),t.isCompleted&&(0,e.jsx)(F,{className:"bg-green-500 text-white hover:bg-green-600",children:"Completed"})]}),(0,e.jsx)("p",{className:"text-xl text-muted-foreground",children:t.description})]}),(0,e.jsx)(j,{className:"border-2 shadow-sm",children:(0,e.jsx)(le,{className:"p-8 prose dark:prose-invert max-w-none",children:(0,e.jsx)("div",{className:"whitespace-pre-wrap font-sans text-lg leading-relaxed",children:t.content_markdown})})}),t.codeSnippet&&(0,e.jsxs)("div",{className:"relative group rounded-xl overflow-hidden shadow-2xl border border-border",children:[(0,e.jsx)("div",{className:"absolute top-0 right-0 bg-muted px-3 py-1 text-xs font-mono rounded-bl-xl border-l border-b border-border text-muted-foreground",children:"C#"}),(0,e.jsx)("pre",{className:"bg-zinc-950 text-zinc-50 p-6 font-mono text-sm overflow-x-auto",children:(0,e.jsx)("code",{children:t.codeSnippet})})]}),(0,e.jsx)("div",{className:"pt-8 flex justify-end",children:(0,e.jsxs)(T,{size:"lg",onClick:()=>s("game"),className:"text-lg px-8 h-14 shadow-xl font-bold",children:[t.isCompleted?"Practice Again":"Start Challenge",(0,e.jsx)(ne,{className:"w-5 h-5 ml-2"})]})})]})})},"lesson"),i==="game"&&(0,e.jsxs)(b.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},exit:{opacity:0,x:20},className:"absolute inset-0 overflow-hidden flex flex-col items-center justify-center",children:[(0,e.jsx)("div",{className:"w-full max-w-2xl mx-auto p-6 pb-40 overflow-y-auto h-full flex flex-col justify-center",children:S?(0,e.jsx)(pt,{stats:{timeSeconds:G,accuracy:r>0?Math.max(0,Math.round((r-u.size)/r*100)):100,totalQuestions:r},rewards:{xp:t.xp_reward||50,coins:Math.floor((t.xp_reward||50)/10)},onContinue:()=>f(G)}):(0,e.jsx)(e.Fragment,{children:c?(0,e.jsxs)("div",{className:"space-y-8",children:[(0,e.jsxs)("div",{className:"text-center space-y-2",children:[(0,e.jsx)("h2",{className:"text-3xl font-bold",children:c.prompt}),(0,e.jsxs)("p",{className:"text-muted-foreground",children:["Question ",O+1," of"," ",A.length]})]}),(0,e.jsx)(j,{className:"border-none shadow-none bg-transparent",children:(0,e.jsxs)(le,{className:"p-0",children:[c.type==="QUIZ"&&(0,e.jsx)(lt,{data:c.data,onComplete:I,hintCount:M,onConsumeHint:h}),c.type==="BUILDING_BLOCKS"&&(0,e.jsx)(dt,{data:c.data,onComplete:I,hintCount:M,onConsumeHint:h}),c.type==="MATCHING"&&(0,e.jsx)(ct,{data:c.data,onComplete:I,hintCount:M,onConsumeHint:h})]})})]},O):(0,e.jsx)("div",{className:"text-center space-y-6 py-12",children:(0,e.jsx)(ve,{className:"animate-spin h-8 w-8 mx-auto text-muted-foreground"})})})}),(0,e.jsx)(W,{children:d!=="idle"&&(0,e.jsxs)(b.div,{initial:{y:100},animate:{y:0},exit:{y:100},transition:{type:"spring",stiffness:300,damping:30},className:D("absolute bottom-0 left-0 right-0 p-6 border-t-2 z-50 flex flex-col sm:flex-row items-center justify-between gap-4 shadow-2xl",d==="correct"?"bg-green-100 border-green-200 dark:bg-green-950/90 dark:border-green-900":"bg-red-100 border-red-200 dark:bg-red-950/90 dark:border-red-900"),children:[(0,e.jsxs)("div",{className:"flex items-center gap-4 w-full sm:w-auto",children:[(0,e.jsx)("div",{className:D("w-12 h-12 rounded-full flex shrink-0 items-center justify-center border-4 bg-white",d==="correct"?"border-green-500 text-green-600":"border-red-500 text-red-600"),children:d==="correct"?(0,e.jsx)(oe,{className:"w-8 h-8 stroke-[3]"}):(0,e.jsx)(Ne,{className:"w-8 h-8 stroke-[3]"})}),(0,e.jsxs)("div",{className:"text-left",children:[(0,e.jsx)("h3",{className:D("text-2xl font-black",d==="correct"?"text-green-700 dark:text-green-400":"text-red-700 dark:text-red-400"),children:d==="correct"?"Nice job!":"Incorrect"}),d==="wrong"&&(0,e.jsx)("p",{className:"text-red-600 dark:text-red-300 text-sm font-medium",children:"Don't worry, keep going!"})]})]}),(0,e.jsx)(T,{onClick:E,size:"lg",className:D("w-full sm:w-auto min-w-[150px] font-black text-lg h-12 border-b-4 active:border-b-0 active:translate-y-1 transition-all",d==="correct"?"bg-green-500 hover:bg-green-600 text-white border-green-700 shadow-green-900/20":"bg-red-500 hover:bg-red-600 text-white border-red-700 shadow-red-900/20"),children:"CONTINUE"})]})})]},"game")]})})]})}function bt(){let t=Be(),{user:a,syncUser:f}=ye(),{grantXP:x}=st(),{hearts:h,timeRemaining:k,buyHearts:i}=Ae(a),[s,S]=(0,v.useState)([]),[w,A]=(0,v.useState)(!0),[L,O]=(0,v.useState)(null),[m,r]=(0,v.useState)(0),[p,u]=(0,v.useState)({level:1,completed_chapters:0,total_chapters:0}),[_,M]=(0,v.useState)([]),[P,G]=(0,v.useState)(null),Q=(0,v.useCallback)(async()=>{if(a)try{A(!0);let{data:l,error:d}=await U.from("users").select("level, completed_chapters, hints, streak_freezes").eq("id",a.uid).single();d&&console.error("Error fetching stats:",d);let{data:N}=await U.from("lessons").select("id, order_index").order("order_index",{ascending:!0}),c=N?.length||0,I=l?.completed_chapters||[],E=0;if(N){let g=N.filter(y=>I.includes(y.id));g.length>0&&(E=Math.max(...g.map(y=>y.order_index)))}if(r(E),l){u({level:l.level||1,completed_chapters:I.length,total_chapters:c});let g=[{name:"Hint",quantity:l.hints||0,icon:se,color:"text-yellow-500",description:"Reveals part of the answer or removes a wrong option."},{name:"Streak Freeze",quantity:l.streak_freezes||0,icon:Ye,color:"text-blue-500",description:"Prevents you from losing your streak if you miss a day."}];M(g.filter(y=>y.quantity>0))}let z=ut.map(g=>{let y=gt.find(q=>q.id===g.id),C=N?.find(q=>q.order_index===g.id),H=C?I.includes(C.id):!1;return{...g,...y,id:C?.id||g.id,activities:y?.activities||[],order_index:g.id,activityType:g.activityLabel,isCompleted:H}});S(z)}catch(l){console.error("Failed to load adventure progress:",l)}finally{A(!1)}},[a]);(0,v.useEffect)(()=>{Q()},[Q]),(0,v.useEffect)(()=>{let l=setTimeout(()=>{if(!w&&s.length>0){let d=document.getElementById("active-chapter-node");d&&d.scrollIntoView({behavior:"smooth",block:"center"})}},500);return()=>clearTimeout(l)},[w,s]);let ue=async()=>{if(!a)return!1;let l=_.find(c=>c.name==="Hint");if(!l||l.quantity<=0)return te.error("No hints left! Visit the shop."),!1;let d=l.quantity-1;M(c=>c.map(I=>I.name==="Hint"?{...I,quantity:d}:I));let{error:N}=await U.from("users").update({hints:d}).eq("id",a.uid);return N?(console.error("Hint db failed:",N),M(c=>c.map(I=>I.name==="Hint"?{...I,quantity:l.quantity}:I)),te.error("Failed to use hint."),!1):!0},ge=async(l,d,N)=>{if(!a)return;let{data:c,error:I}=await U.from("users").select("coins, completed_chapters, total_runtime, badges").eq("id",a.uid).single();if(I||!c){console.error("Error fetching user:",I);return}let E=c.completed_chapters||[],z=E.includes(d),g=[...E];z||g.push(d);let y=c.total_runtime||0,C=y;if(z){let{data:ee}=await U.from("user_lesson_progress").select("completion_time").eq("user_id",a.uid).eq("lesson_id",d).single(),K=ee?.completion_time||0;C=Math.max(0,y-K)+N}else C=y+N;let H=c.badges||[],q=!1,J="Adventure Champion";g.length===s.length&&(H.includes(J)||(H.push(J),q=!0));let Z=(c.coins||0)+l,{error:X}=await U.from("users").update({coins:Z,completed_chapters:g,total_runtime:C,badges:H}).eq("id",a.uid);if(X)console.error("Update failed:",X),te.error(`Save Failed: ${X.message}`);else{u(K=>({...K,completed_chapters:g.length})),S(K=>K.map(he=>he.id===d?{...he,isCompleted:!0}:he));let ee=s.find(K=>K.id===d);ee&&ee.order_index>m&&r(ee.order_index),q&&te.success("\u{1F3C6} BADGE UNLOCKED: Adventure Champion!",{description:"You completed every chapter in the journey. Amazing work!",duration:6e3,style:{border:"2px solid #EAB308",backgroundColor:"#FEF9C3",color:"#854D0E"}})}},$=m+1,ie=$>1?($-1)*(ft+yt)+ft/2:0,fe=async l=>{if(!L||!a)return;let d=L.xp_reward||50,N=Math.floor(d/10);x(d),await ge(N,L.id,l);let c=Z=>{let X=Z.getTimezoneOffset()*6e4;return new Date(Z.getTime()-X).toISOString().split("T")[0]},E=c(new Date),z=a.activeDates?.[a.activeDates.length-1],g=z===E,y="started",C=a.streaks||0,H=new Date;H.setDate(H.getDate()-1);let q=c(H);if(g)y="continued";else{z===q?(y="continued",C+=1):(y="started",C=1);let Z=[...a.activeDates||[],E];f({...a,streaks:C,activeDates:Z}),await U.from("users").update({streaks:C,active_dates:Z}).eq("id",a.uid)}let{error:J}=await U.from("user_lesson_progress").upsert({user_id:a.uid,lesson_id:L.id,status:"completed",completed_at:new Date().toISOString(),completion_time:l},{onConflict:"user_id, lesson_id"});J&&console.error("Error saving lesson progress:",J),G({title:L.title,xp:d,coins:N,streakStatus:y,currentStreak:C}),O(null)};return w?(0,e.jsx)("div",{className:"flex h-screen items-center justify-center",children:(0,e.jsx)(ve,{className:"animate-spin"})}):(0,e.jsxs)("div",{className:"min-h-screen bg-background p-6",children:[(0,e.jsx)(vt,{open:!!P,onClose:()=>G(null),data:P}),(0,e.jsx)(W,{children:!L&&(0,e.jsxs)(b.div,{initial:{opacity:0},animate:{opacity:1},exit:{opacity:0},className:"max-w-4xl mx-auto space-y-8 pb-24",children:[(0,e.jsxs)("div",{className:"flex flex-col gap-6",children:[(0,e.jsxs)(T,{variant:"ghost",className:"w-fit -ml-4 text-muted-foreground hover:text-foreground",onClick:()=>t("/dashboard"),children:[(0,e.jsx)(Pe,{className:"w-4 h-4 mr-2"})," Back to Dashboard"]}),(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsxs)("div",{className:"flex items-center gap-4",children:[(0,e.jsx)("div",{className:"p-3 bg-indigo-100 dark:bg-indigo-900/20 rounded-2xl",children:(0,e.jsx)(Qe,{className:"w-8 h-8 text-indigo-600 dark:text-indigo-400"})}),(0,e.jsxs)("div",{children:[(0,e.jsx)("h1",{className:"text-3xl font-black text-foreground",children:"C# Adventure"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"Your journey from Novice to Architect."})]})]}),(0,e.jsxs)("div",{className:"flex gap-2",children:[(0,e.jsx)(de,{children:(0,e.jsxs)(Ce,{children:[(0,e.jsx)(ke,{asChild:!0,children:(0,e.jsx)(T,{variant:"outline",size:"icon",className:"rounded-full w-10 h-10 border-indigo-200 bg-indigo-50 dark:bg-indigo-900/20 dark:border-indigo-800",children:(0,e.jsx)(Ee,{className:"w-5 h-5 text-indigo-600 dark:text-indigo-400"})})}),(0,e.jsxs)(Se,{align:"end",className:"w-64",children:[(0,e.jsx)(Ie,{children:"Backpack"}),(0,e.jsx)(Te,{}),_.length>0?_.map((l,d)=>{let N=l.icon;return(0,e.jsxs)(ce,{delayDuration:0,children:[(0,e.jsx)(me,{asChild:!0,children:(0,e.jsxs)(tt,{className:"flex justify-between cursor-pointer py-3",children:[(0,e.jsxs)("div",{className:"flex items-center gap-3",children:[(0,e.jsx)("div",{className:D("p-1 rounded-md bg-secondary",l.color),children:(0,e.jsx)(N,{className:"w-4 h-4"})}),(0,e.jsx)("span",{className:"font-medium",children:l.name})]}),(0,e.jsxs)(F,{variant:"secondary",className:"h-5 px-1.5 font-bold",children:[l.quantity,"x"]})]})}),(0,e.jsx)(pe,{side:"right",className:"max-w-[200px] ml-2",children:(0,e.jsx)("p",{children:l.description})})]},d)}):(0,e.jsxs)("div",{className:"p-4 text-sm text-muted-foreground text-center",children:["Your backpack is empty. ",(0,e.jsx)("br",{})," Visit the shop to buy power-ups!"]})]})]})}),(0,e.jsxs)("div",{className:"hidden md:flex items-center gap-2 px-4 py-2 bg-yellow-500/10 text-yellow-600 rounded-full font-bold border border-yellow-500/20",children:[(0,e.jsx)(we,{className:"w-4 h-4 fill-yellow-600"})," Level"," ",p.level]}),(0,e.jsx)(de,{children:(0,e.jsxs)(ce,{delayDuration:0,children:[(0,e.jsx)(me,{asChild:!0,children:(0,e.jsxs)("div",{className:"hidden md:flex items-center gap-2 px-4 py-2 bg-blue-500/10 text-blue-600 rounded-full font-bold border border-blue-500/20 cursor-default",children:[(0,e.jsx)(ae,{className:"w-4 h-4 fill-blue-600"}),p.completed_chapters," / ",p.total_chapters]})}),(0,e.jsx)(pe,{children:(0,e.jsx)("p",{children:"Chapters Completed"})})]})}),(0,e.jsx)(ht,{hearts:h,timeRemaining:k,buyHearts:i})]})]})]}),(0,e.jsxs)("div",{className:"relative w-full mt-12",children:[(0,e.jsx)("div",{className:"absolute top-0 left-1/2 -translate-x-1/2 h-full w-2 bg-muted rounded-full"}),(0,e.jsx)(b.div,{initial:{height:0},animate:{height:ie},transition:{duration:1.5,ease:"easeInOut"},className:"absolute top-0 left-1/2 -translate-x-1/2 w-2 bg-gradient-to-b from-green-400 to-green-600 rounded-full z-0 shadow-[0_0_15px_rgba(34,197,94,0.6)]"}),(0,e.jsx)("div",{className:"relative z-10 flex flex-col items-center gap-8",children:s.map((l,d)=>{let N=d+1,c="locked";return l.isCompleted?c="completed":N===m+1&&(c="current"),(0,e.jsx)(xt,{id:c==="current"?"active-chapter-node":void 0,chapter:l,status:c,alignment:d%2===0?"left":"right",onClick:()=>O(l)},l.id)})}),(0,e.jsx)("div",{className:"flex justify-center mt-12",children:(0,e.jsx)(b.div,{initial:{scale:0},whileInView:{scale:1},className:"w-24 h-24 bg-gradient-to-br from-yellow-100 to-yellow-200 dark:from-yellow-900/40 dark:to-yellow-800/20 rounded-full flex items-center justify-center border-4 border-yellow-400 shadow-xl z-10",children:(0,e.jsx)(we,{className:"w-12 h-12 text-yellow-600 fill-yellow-500"})})})]})]})}),(0,e.jsx)(W,{children:L&&(0,e.jsx)(wt,{chapter:L,onClose:()=>O(null),onComplete:fe,inventory:_,onUseHint:ue})})]})}export{bt as default};
