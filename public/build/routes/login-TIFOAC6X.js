import{B as F,C as L,D as A,E as T,F as i,l as I,m as D,n as C,o as q,p as B,q as k}from"/build/_shared/chunk-UZW6IDI3.js";import{a as U,b as V}from"/build/_shared/chunk-TK4TCGZJ.js";import{c as o,d as l}from"/build/_shared/chunk-YXIPPUDP.js";import{b as w,j as W}from"/build/_shared/chunk-GQOCD34X.js";import{e as S,g as O}from"/build/_shared/chunk-ERM4YBQE.js";import{A as j,Fa as m,L as H,M as z,a as M,j as _,ta as G,z as X}from"/build/_shared/chunk-UEXE7SL4.js";import{a as $,c as E,m as Y}from"/build/_shared/chunk-UN5IVU4J.js";import{e as x}from"/build/_shared/chunk-ADMCF34Z.js";var t=x($(),1);var e=x(Y(),1);function J(){let[r,n]=(0,t.useState)(""),[d,u]=(0,t.useState)(""),[p,f]=(0,t.useState)(!1),[v,h]=(0,t.useState)(""),[N,a]=(0,t.useState)(!1),[s,c]=(0,t.useState)(!1),[g,R]=(0,t.useState)(!1),{loginWithStudentId:K,signInWithGoogle:Q}=O(),P=E(),Z=async b=>{b.preventDefault(),h(""),a(!0);try{let y=await K(r,d);y&&(y.isOnboarded?P("/dashboard"):P("/onboarding"))}catch(y){console.error(y),h("Invalid Student ID or Password")}finally{a(!1)}};return(0,e.jsxs)("div",{className:"min-h-screen w-full flex bg-white dark:bg-gray-900 relative transition-colors duration-300",children:[(0,e.jsx)("div",{className:"absolute top-4 right-4 z-50",children:(0,e.jsx)(V,{})}),(0,e.jsxs)("div",{className:"hidden lg:flex w-1/2 bg-gray-900 relative overflow-hidden items-center justify-center p-12",children:[(0,e.jsx)(w.div,{animate:{scale:[1,1.2,1],rotate:[0,90,0]},transition:{duration:20,repeat:1/0,ease:"linear"},className:"absolute top-[-20%] left-[-20%] w-[80%] h-[80%] bg-indigo-600/20 rounded-full blur-3xl"}),(0,e.jsxs)("div",{className:"relative z-10 text-center space-y-6 max-w-lg",children:[(0,e.jsx)("div",{className:"flex justify-center mb-6",children:(0,e.jsx)("div",{className:"p-6 bg-white/10 backdrop-blur-xl rounded-3xl shadow-2xl border border-white/10",children:(0,e.jsx)(W,{className:"h-24 w-24"})})}),(0,e.jsx)("h1",{className:"text-5xl font-extrabold text-white tracking-tight font-pixelify",children:"CodeON"}),(0,e.jsx)("p",{className:"text-lg text-gray-300",children:"Enter the battlefield. Master the code. Claim your victory."})]})]}),(0,e.jsx)("div",{className:"w-full lg:w-1/2 flex items-center justify-center p-8",children:(0,e.jsxs)(w.div,{initial:{opacity:0,x:20},animate:{opacity:1,x:0},className:"w-full max-w-md space-y-8",children:[(0,e.jsxs)("div",{className:"text-center lg:text-left",children:[(0,e.jsx)("h2",{className:"text-3xl font-bold text-gray-900 dark:text-white",children:"Student Access"}),(0,e.jsx)("p",{className:"mt-2 text-gray-600 dark:text-gray-400",children:"Please log in with your university credentials."})]}),(0,e.jsxs)("div",{className:"space-y-6",children:[v&&(0,e.jsxs)("div",{className:"p-4 text-sm text-red-500 bg-red-50 dark:bg-red-950/50 border border-red-200 dark:border-red-900 rounded-xl flex items-center gap-2",children:[(0,e.jsx)(M,{className:"w-4 h-4"}),v]}),(0,e.jsxs)("form",{onSubmit:Z,className:"space-y-5",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{htmlFor:"studentId",className:"text-base",children:"Student ID No."}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(G,{className:"absolute left-4 top-3.5 h-5 w-5 text-gray-400"}),(0,e.jsx)(l,{id:"studentId",placeholder:"e.g., 2023-10245",required:!0,className:"pl-12 h-12 text-lg font-mono",value:r,onChange:b=>n(b.target.value)})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsxs)("div",{className:"flex items-center justify-between",children:[(0,e.jsx)(o,{htmlFor:"password",className:"text-base",children:"Password"}),(0,e.jsx)("button",{type:"button",onClick:()=>c(!0),className:"text-sm font-medium text-indigo-600 hover:text-indigo-500",children:"Forgot password?"})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(z,{className:"absolute left-4 top-3.5 h-5 w-5 text-gray-400"}),(0,e.jsx)(l,{id:"password",type:p?"text":"password",required:!0,className:"pl-12 pr-12 h-12 text-lg",value:d,onChange:b=>u(b.target.value)}),(0,e.jsx)("button",{type:"button",onClick:()=>f(!p),className:"absolute right-4 top-3.5 text-gray-400 hover:text-gray-600 dark:hover:text-gray-200",children:p?(0,e.jsx)(X,{className:"h-5 w-5"}):(0,e.jsx)(j,{className:"h-5 w-5"})})]})]}),(0,e.jsx)(m,{className:"w-full h-12 text-lg font-bold bg-indigo-600 hover:bg-indigo-700 shadow-lg",type:"submit",disabled:N,children:N?(0,e.jsx)(H,{className:"animate-spin"}):"Sign In"})]}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)("div",{className:"absolute inset-0 flex items-center",children:(0,e.jsx)(U,{})}),(0,e.jsx)("div",{className:"relative flex justify-center text-xs uppercase",children:(0,e.jsx)("span",{className:"bg-white dark:bg-gray-900 px-2 text-muted-foreground font-medium",children:"Bound Accounts Only"})})]}),(0,e.jsx)(m,{variant:"outline",className:"w-full h-12 text-base font-medium",onClick:()=>Q(),children:"Sign in with Google"}),(0,e.jsxs)("p",{className:"text-center text-sm text-gray-600 dark:text-gray-400",children:["Don't have an account yet?"," ",(0,e.jsx)("button",{onClick:()=>R(!0),className:"font-bold text-indigo-600 hover:text-indigo-500 transition-colors underline",children:"Request Access"})]})]})]})}),(0,e.jsx)(ee,{isOpen:s,onClose:()=>c(!1)}),(0,e.jsx)(te,{isOpen:g,onClose:()=>R(!1)})]})}function ee({isOpen:r,onClose:n}){let[d,u]=(0,t.useState)(!1);return(0,e.jsx)(I,{open:r,onOpenChange:n,children:(0,e.jsxs)(D,{children:[(0,e.jsxs)(C,{children:[(0,e.jsx)(B,{children:"Reset Password"}),(0,e.jsxs)(k,{children:["Default passwords follow the format:"," ",(0,e.jsx)("span",{className:"font-mono bg-gray-100 dark:bg-gray-800 px-1 rounded text-foreground font-bold",children:"IciYYYY-MM-DD"})," ","(based on your birthdate)"]})]}),d?(0,e.jsxs)("div",{className:"py-6 text-center space-y-2",children:[(0,e.jsx)("h3",{className:"font-bold text-lg",children:"Request Sent!"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"Please contact your professor if you do not receive a reset link within 24 hours."}),(0,e.jsx)(m,{onClick:n,className:"mt-4",children:"Close"})]}):(0,e.jsxs)("form",{onSubmit:f=>{f.preventDefault(),u(!0)},className:"space-y-4 py-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Student ID"}),(0,e.jsx)(l,{placeholder:"Enter your ID",required:!0})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Personal Email"}),(0,e.jsx)(l,{type:"email",placeholder:"For verification",required:!0})]}),(0,e.jsx)(q,{children:(0,e.jsx)(m,{type:"submit",children:"Submit Request"})})]})]})})}function te({isOpen:r,onClose:n}){let[d,u]=(0,t.useState)(!1),[p,f]=(0,t.useState)(!1),[v,h]=(0,t.useState)([]);return(0,t.useEffect)(()=>{r&&(async()=>{let{data:s,error:c}=await S.from("users").select("id, display_name").eq("role","instructor");s&&h(s),c&&console.error("Error fetching instructors:",c)})()},[r]),(0,e.jsx)(I,{open:r,onOpenChange:n,children:(0,e.jsxs)(D,{className:"sm:max-w-[425px]",children:[(0,e.jsxs)(C,{children:[(0,e.jsx)(B,{children:"Request Account Access"}),(0,e.jsx)(k,{children:"Fill out the details below. Your professor will approve your request."})]}),p?(0,e.jsxs)("div",{className:"py-8 text-center space-y-3",children:[(0,e.jsx)("h3",{className:"font-bold text-xl text-green-600",children:"Request Sent!"}),(0,e.jsx)("p",{className:"text-muted-foreground",children:"Your account request has been forwarded to the admin. You will be notified once approved."}),(0,e.jsx)(m,{onClick:n,variant:"outline",children:"Close"})]}):(0,e.jsxs)("form",{onSubmit:async a=>{a.preventDefault(),u(!0);let s=new FormData(a.currentTarget),c={student_id:s.get("studentNo"),full_name:s.get("fullName"),section:s.get("section"),professor:s.get("professor"),birthdate:s.get("birthdate"),status:"pending",created_at:new Date().toISOString()};try{let{error:g}=await S.from("account_requests").insert([c]);if(g)throw g;f(!0)}catch(g){console.error(g),alert("Failed to submit request. Please try again.")}finally{u(!1)}},className:"space-y-4 py-4",children:[(0,e.jsxs)("div",{className:"grid grid-cols-2 gap-4",children:[(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Student No."}),(0,e.jsx)(l,{name:"studentNo",required:!0,placeholder:"202X-XXXX"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Section"}),(0,e.jsxs)(F,{name:"section",required:!0,children:[(0,e.jsx)(A,{children:(0,e.jsx)(L,{placeholder:"Select"})}),(0,e.jsxs)(T,{children:[(0,e.jsx)(i,{value:"BSIT-1A",children:"BSIT-1A"}),(0,e.jsx)(i,{value:"BSIT-1B",children:"BSIT-1B"}),(0,e.jsx)(i,{value:"BSCS-1A",children:"BSCS-1A"}),(0,e.jsx)(i,{value:"BSAIS",children:"BSAIS"}),(0,e.jsx)(i,{value:"ACT",children:"ACT"}),(0,e.jsx)(i,{value:"BSIS",children:"BSIS"})]})]})]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Full Name"}),(0,e.jsx)(l,{name:"fullName",required:!0,placeholder:"Last Name, First Name"})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Birthdate"}),(0,e.jsxs)("div",{className:"relative",children:[(0,e.jsx)(_,{className:"absolute left-3 top-2.5 h-4 w-4 text-gray-400"}),(0,e.jsx)(l,{name:"birthdate",type:"date",required:!0,className:"pl-10"})]}),(0,e.jsxs)("p",{className:"text-[11px] text-muted-foreground",children:[(0,e.jsx)("span",{className:"font-bold text-indigo-500",children:"Note:"})," This date will be used to generate your default password (Format:"," ",(0,e.jsx)("span",{className:"font-mono",children:"IciYYYY-MM-DD"}),")."]})]}),(0,e.jsxs)("div",{className:"space-y-2",children:[(0,e.jsx)(o,{children:"Professor / Instructor"}),(0,e.jsxs)(F,{name:"professor",required:!0,children:[(0,e.jsx)(A,{children:(0,e.jsx)(L,{placeholder:"Select Instructor"})}),(0,e.jsx)(T,{children:v.length>0?v.map(a=>(0,e.jsx)(i,{value:a.display_name,children:a.display_name},a.id)):(0,e.jsx)("div",{className:"p-2 text-sm text-gray-500 text-center",children:"No instructors found"})})]})]}),(0,e.jsx)(q,{children:(0,e.jsx)(m,{type:"submit",disabled:d,children:d?"Submitting...":"Submit Request"})})]})]})})}export{J as default};
